<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CF369D Valera and Fools 题解 - 我的个人博客</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <!-- MathJax 配置脚本，必须在加载 MathJax 主脚本之前 -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
    
    <style>
        body { background-size: cover; background-position: center; background-attachment: fixed; font-family: 'Noto Sans SC', sans-serif; transition: background-image 1s ease-in-out; }
        .card { box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); border: 1px solid rgba(0,0,0,0.05); }
        html { scroll-behavior: smooth; }
        pre[class*="language-"] { padding: 1rem; margin: 1.5rem 0; border-radius: 0.5rem; }
        /* 为行内代码块添加样式 */
        :not(pre) > code {
            background-color: #f3f4f6; /* bg-gray-100 */
            color: #be123c; /* text-rose-700 */
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.9em;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="container mx-auto p-4 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-5xl font-bold text-gray-900 tracking-wider">Alexxtl的博客</h1>
            <p class="text-gray-600 mt-2">记录、分享、成长</p>
        </header>
        <div class="flex flex-col lg:flex-row gap-8">
            <aside class="w-full lg:w-1/4 flex-shrink-0">
                <div class="space-y-8">
                    <div class="bg-white/70 backdrop-blur-sm rounded-xl p-6 text-center card">
                        <img src="images/avatar.png" alt="博主头像" class="w-32 h-32 rounded-full mx-auto mb-4 border-4 border-white shadow-lg">
                        <h2 class="text-2xl font-bold">Alexxtl</h2>
                        <p class="text-gray-600 mt-2">一个热爱技术与生活的开发者。</p>
                        <div class="flex justify-center flex-wrap gap-x-4 gap-y-2 mt-4">
                            <a href="https://github.com/Alexxtl" target="_blank" class="text-gray-500 hover:text-indigo-600 transition-colors">GitHub</a>
                            <a href="https://www.luogu.com.cn/user/598187" target="_blank" class="text-gray-500 hover:text-indigo-600 transition-colors">Luogu</a>
                            <a href="https://blog.csdn.net/Alexxtl" target="_blank" class="text-gray-500 hover:text-indigo-600 transition-colors">CSDN</a>
                            <a href="https://codeforces.com/profile/Alex_xtl" target="_blank" class="text-gray-500 hover:text-indigo-600 transition-colors">Codeforces</a>
                            <a href="https://atcoder.jp/users/xiaotianlin" target="_blank" class="text-gray-500 hover:text-indigo-600 transition-colors">AtCoder</a>
                        </div>
                    </div>
                    <div class="bg-white/70 backdrop-blur-sm rounded-xl p-6 card">
                        <h3 class="text-xl font-bold mb-4 border-b pb-2">文章标签</h3>
                        <div class="flex flex-wrap gap-2">
                           
                        </div>
                    </div>
                    <div class="bg-white/70 backdrop-blur-sm rounded-xl p-6 card">
                        <h3 class="text-xl font-bold mb-4 border-b pb-2">友情链接</h3>
                        <ul class="space-y-3 text-gray-700">
                            <li><a href="https://blog.csdn.net/BabyFalse?type=blog" class="hover:text-indigo-600 transition-colors" target="_blank">xwj</a></li>
                            <li><a href="https://www.cnblogs.com/MrSWdAxiv" class="hover:text-indigo-600 transition-colors" target="_blank">fzy</a></li>
                        </ul>
                    </div>
                </div>
            </aside>
            <main class="w-full lg:flex-grow bg-white/70 backdrop-blur-sm rounded-xl p-8 lg:p-12 card">
                <a href="https://alexxtl.github.io/blog/" class="text-indigo-600 hover:underline mb-6 inline-block">&larr; 返回首页</a>
                <h1 class="text-4xl font-bold mb-4 text-gray-900">CF369D Valera and Fools 题解</h1>
                <div class="text-gray-500 mb-8 border-b pb-4">
                    <span>发布于：2025年09月20日</span> | 
                    <span>作者：Alexxtl</span> | 
                    <span>分类：<a href="#" class="text-purple-600 hover:underline">未分类</a></span>
                </div>
                <article class="prose prose-lg max-w-none text-gray-800">
<p><a href="https://www.cnblogs.com/Alexxtl/p/18294941" class="text-indigo-600 hover:underline" target="_blank"><strong>更好的阅读体验</strong></a></p>
<h2 class="text-2xl font-bold mt-8 mb-4">题目链接</h2>
<p><a href="https://www.luogu.com.cn/problem/CF369D" class="text-indigo-600 hover:underline" target="_blank"><strong>Luogu</strong></a></p>
<p><a href="https://codeforces.com/problemset/problem/369/D" class="text-indigo-600 hover:underline" target="_blank"><strong>Codeforces</strong></a></p>
<h2 class="text-2xl font-bold mt-8 mb-4">题意简述</h2>
<p>有 $n$ 个人站成一排，每人手中有 $k$ 发子弹，每次每人会向除自己外编号最小的人开枪，第 $i$ 个人开枪的命中率为 $p_i \%$，剩余最多一人时结束，问有多少种可能的局面。</p>
<h2 class="text-2xl font-bold mt-8 mb-4">解法说明</h2>
<p>从题目要求中可以发现，每次一定是编号最小的人向编号第二小的人开枪，其余人向编号最小的人开枪，也就是说，每次只有编号最小和第二小的两个人受到枪击。</p>
<p>故对于每一轮，我们可以设此时编号最小的和第二小的人分别为 $x,y$，令 $f_{x,y}$ 表示转移到 $x,y$ 所需要的步数（即消耗的子弹数）则会有以下四种情况：</p>
<ul class="list-disc pl-5 my-4">
<li><strong>两人都未被击中</strong></li>
</ul>
<p>未发生变化，忽略。</p>
<ul class="list-disc pl-5 my-4">
<li><strong>$x$ 被击中，而 $y$ 幸存</strong></li>
</ul>
<p>此时如满足 $p_x<100$（否则 $y$ 必然被击中）且 $\exists i \in [y,n], p_i>0$（否则 $x$ 无法被击中），则转移到 $f_{y,y+1}$；</p>
<ul class="list-disc pl-5 my-4">
<li><strong>$x$ 幸存，而 $y$ 被击中</strong></li>
</ul>
<p>此时如满足 $p_x>0$（否则 $y$ 无法被击中）且 $\forall i \in [y,n], p_i \ne 0$（否则 $x$ 必然被击中），则转移到 $f_{x,y+1}$；</p>
<ul class="list-disc pl-5 my-4">
<li><strong>$x$ 与 $y$ 都被击中</strong></li>
</ul>
<p>此时如满足 $p_x>0$（否则 $y$ 无法被击中）且 $\exists i \in [y,n], p_i>0$（否则 $x$ 无法被击中），则转移到 $f_{y+1,y+2}$。</p>
<p>剩余细节详见下面代码中的注释。</p>
<h2 class="text-2xl font-bold mt-8 mb-4">通过代码</h2>
<pre><code class="language-cpp">#include&lt;bits/stdc++.h&gt;
using namespace std;
#define PII pair&lt;int,int&gt;
#define mp make_pair
const int N=3010;

int n,k,p[N],f[N][N],ans;//ans表示可能的局面的数量
bool Genshin[N],Impact[N];//Genshin[i]表示j取[i,n]中任意值时时是否有p[i]&gt;0,Impact[i]表示j取[i,n]中任意值时时是否有p[i]=100
queue&lt;PII&gt; q;

inline int read(){
    int x=0,f=1;
    char ch=getchar();
    while(ch&lt;&apos;0&apos;||ch&gt;&apos;9&apos;){
        if(ch==&apos;-&apos;){
            f=-1;
        }
        ch=getchar();
    }
    while(ch&gt;=&apos;0&apos;&amp;&amp;ch&lt;=&apos;9&apos;){
        x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^48);
        ch=getchar();
    }
    return x*f;
}//快读 

inline void write(int x){
    if(x&lt;0){
        putchar(&apos;-&apos;);
        x=-x;
    }
    if(x&gt;9){
        write(x/10);
    }
    putchar(x%10+&apos;0&apos;);
}//快写 

int main(){
    n=read(),k=read();
    for(int i=1;i&lt;=n;i++){
        p[i]=read();
    }
    for(int i=n;i&gt;=1;i--){
        if(Genshin[i+1]||p[i]&gt;0){ 
            Genshin[i]=1;
        }//预处理出Genshin[i]
        if(Impact[i+1]||p[i]==100){
            Impact[i]=1; 
        }//预处理出Impact[i]
    }
    q.push(mp(1,2));
    while(!q.empty()){
        int x=q.front().first,y=q.front().second;
        q.pop();
        if(y&gt;n||f[x][y]&gt;=k){
            continue;
        }//跳过无法转移的情况（剩余人数不大于1或子弹耗尽） 
        if(Genshin[y]&amp;&amp;p[x]!=100){
            if(!f[y][y+1]){
                f[y][y+1]=f[x][y]+1;
                ans++;
                q.push(mp(y,y+1));
            }
        }//x被击中，y幸存 
        if(!Impact[y]&amp;&amp;p[x]&gt;0){
            if(!f[x][y+1]){
                f[x][y+1]=f[x][y]+1;
                ans++;
                q.push(mp(x,y+1));
			}
        }//x幸存，y被击中 
        if(Genshin[y]&amp;&amp;p[x]&gt;0){
            if(!f[y+1][y+2]){
                f[y+1][y+2]=f[x][y]+1;
                ans++;
                q.push(mp(y+1,y+2));
            }
        }//x与y都被击中 
    }
    write(ans+1);//答案要加处在状态(1,2)时的情况 
    return 0;
}
</code></pre>

                </article>
            </main>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const reliableApi = 'https://api.waifu.pics/sfw/waifu';
            fetch(reliableApi).then(response => response.json()).then(data => {
                const img = new Image();
                img.src = data.url;
                img.onload = () => { document.body.style.backgroundImage = `url('${data.url}')`; };
            }).catch(() => { document.body.style.backgroundColor = '#f3f4f6'; });
        });
    </script>
</body>
</html>